---
import { lunalink } from '@bearstudio/lunalink';
import type { GetStaticPathsOptions } from 'astro';
import { ArrowLeft, ArrowRight } from 'lucide-react';

import { getSkillsCollection } from '@/lib/skills';
import SEO from '@/components/SEO/index.astro';
import MainLayout from '@/layouts/MainLayout.astro';
import { ROUTES } from '@/routes.gen';

export async function getStaticPaths({ paginate }: GetStaticPathsOptions) {
  const skills = await getSkillsCollection();
  return paginate(skills, { pageSize: 25 });
}
const { page } = Astro.props;
---

<MainLayout>
  <!-- [TODO]: Metadata -->
  <SEO slot="seo" title="CompÃ©tences" noindex={page.data.length === 0} />
  <div class="mx-auto w-full max-w-screen-xl px-4">
    <div class="grid gap-4 md:grid-cols-2 lg:grid-cols-3">
      {
        page.currentPage !== 1 && (
          <div class="flex items-center md:col-span-2">
            <h3 class="text-sm tracking-widest text-balance uppercase opacity-60">
              Page {page.currentPage}
            </h3>
            <div class="ml-auto flex gap-2">
              {!!page.url.next && (
                <a href={page.url.next}>
                  <ArrowLeft className="size-4" />
                  <span class="sr-only">Older articles</span>
                </a>
              )}
              {!!page.url.prev && (
                <a href={page.url.prev}>
                  <span class="sr-only">Newer articles</span>
                  <ArrowRight className="size-4" />
                </a>
              )}
            </div>
          </div>
        )
      }

      {
        page.data.map((skill) => (
          <a
            href={lunalink(ROUTES.skills[':id'].__path, {
              id: skill.id,
            })}
          >
            {skill.data.name}
          </a>
        ))
      }

      <div class="flex items-center justify-between md:col-span-2">
        {
          !!page.url.prev && (
            <a href={page.url.prev}>
              Newer <span class="max-xs:sr-only">articles</span>
              <ArrowLeft />
            </a>
          )
        }
        {
          !!page.url.next && (
            <a href={page.url.next}>
              <ArrowRight /> Older <span class="max-xs:sr-only">articles</span>
            </a>
          )
        }
      </div>
    </div>
  </div>
</MainLayout>
